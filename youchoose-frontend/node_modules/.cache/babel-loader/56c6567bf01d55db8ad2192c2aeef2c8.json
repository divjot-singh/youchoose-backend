{"ast":null,"code":"var _jsxFileName = \"/Users/divjotsingh/Documents/Youchoose/youchoose/src/providers/userProvider.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useEffect, useState } from \"react\";\nimport { SnackbarTypes } from \"../components/snackbar\";\nimport { instanceOfError } from \"../entities/error\";\nimport { instanceOfUser } from \"../entities/user\";\nimport Authenticate from \"../services/authService\";\nimport { GetCurrentUser, Logout } from \"../services/firebaseService\";\nimport NetworkService from \"../services/networkService\";\nimport { API_ENDPOINTS } from \"../utils/apiEndpoints\";\nimport { useCommonComponents } from \"./commonComponentsProvider\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UserContext = /*#__PURE__*/createContext({\n  user: null,\n  authenticate: async authType => {},\n  signOut: async () => {}\n});\nexport const UserContextWrapper = _ref => {\n  _s();\n\n  let {\n    children,\n    isAppInitialised\n  } = _ref;\n  const [user, setUser] = useState(null);\n  const commonComponents = useCommonComponents();\n\n  const setInitialUser = async () => {\n    commonComponents.showLoader(null);\n    const currentUser = await GetCurrentUser();\n\n    if (instanceOfError(currentUser)) {\n      commonComponents.showSnackbar({\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: currentUser.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 32,\n          columnNumber: 53\n        }, this),\n        type: SnackbarTypes.ERROR\n      });\n    } else {\n      setUser(currentUser);\n    }\n\n    commonComponents.hideLoader();\n  };\n\n  useEffect(() => {\n    if (isAppInitialised) {\n      setInitialUser();\n    }\n  }, [isAppInitialised]);\n\n  const authenticate = async (authType, email, password, username) => {\n    commonComponents.showLoader(null);\n    const result = await Authenticate(authType, email, password, username);\n\n    if (instanceOfUser(result)) {\n      const appUser = await NetworkService.post({\n        url: API_ENDPOINTS.registerUser,\n        data: result\n      });\n\n      if (instanceOfUser(appUser)) {\n        setUser(result);\n      }\n    } else if (instanceOfError(result)) {\n      commonComponents.showSnackbar({\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: result.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 53\n        }, this),\n        type: SnackbarTypes.ERROR\n      });\n    }\n\n    commonComponents.hideLoader();\n  };\n\n  const signOut = async () => {\n    commonComponents.showLoader(null);\n    await Logout();\n    commonComponents.hideLoader();\n    setUser(null);\n  };\n\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      user,\n      authenticate,\n      signOut\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 9\n  }, this);\n};\n\n_s(UserContextWrapper, \"M1ez9CEPXY4ESt62ZmmtCGXoyQI=\", false, function () {\n  return [useCommonComponents];\n});\n\n_c = UserContextWrapper;\nexport const useAuth = () => {\n  _s2();\n\n  return useContext(UserContext);\n};\n\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"UserContextWrapper\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","SnackbarTypes","instanceOfError","instanceOfUser","Authenticate","GetCurrentUser","Logout","NetworkService","API_ENDPOINTS","useCommonComponents","UserContext","user","authenticate","authType","signOut","UserContextWrapper","children","isAppInitialised","setUser","commonComponents","setInitialUser","showLoader","currentUser","showSnackbar","message","type","ERROR","hideLoader","email","password","username","result","appUser","post","url","registerUser","data","useAuth"],"sources":["/Users/divjotsingh/Documents/Youchoose/youchoose/src/providers/userProvider.tsx"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from \"react\";\nimport { SnackbarTypes } from \"../components/snackbar\";\nimport {Error as AppError, instanceOfError} from \"../entities/error\";\nimport User, { instanceOfUser } from \"../entities/user\";\nimport Authenticate, { AuthType } from \"../services/authService\";\nimport { GetCurrentUser, Logout } from \"../services/firebaseService\";\nimport NetworkService from \"../services/networkService\";\nimport { API_ENDPOINTS } from \"../utils/apiEndpoints\";\nimport { CommonComponentsContextValue, useCommonComponents } from \"./commonComponentsProvider\";\n\ninterface UserContextWrapperProps{\n    children: JSX.Element | null,\n    isAppInitialised: boolean\n}\nexport interface UserContextValue{\n    user: User | null;\n    authenticate: (authType: AuthType, email?:string, password?:string, username?:string) => Promise<void>\n    signOut: () => Promise<void>\n}\nconst UserContext = createContext<UserContextValue>({\n    user:null,\n    authenticate:async (authType) => {},\n    signOut:async () => {}\n})\nexport const UserContextWrapper = ({children,isAppInitialised}: UserContextWrapperProps) => {\n    const [user, setUser] = useState<User | null>(null)\n    const commonComponents:CommonComponentsContextValue = useCommonComponents()\n    const setInitialUser = async () => {\n        commonComponents.showLoader(null)\n        const currentUser:User | null | AppError= await GetCurrentUser()\n        if(instanceOfError(currentUser)){\n            commonComponents.showSnackbar({children:<span>{currentUser.message}</span>,type:SnackbarTypes.ERROR})\n        } else {\n            setUser(currentUser)\n        }\n        commonComponents.hideLoader()\n    }\n    useEffect(() => {\n        if(isAppInitialised){\n            setInitialUser()\n        }\n    },[isAppInitialised])\n    const authenticate = async (authType:AuthType, email?:string, password?:string, username?:string) => {\n        commonComponents.showLoader(null)\n        const result:User | null | AppError = await Authenticate(authType, email, password, username);\n        if(instanceOfUser(result)){\n            const appUser: User | null | AppError = await NetworkService.post({url:API_ENDPOINTS.registerUser, data:result})\n            if(instanceOfUser(appUser)){\n                setUser(result)\n            }\n        }\n        else if(instanceOfError(result)){\n            commonComponents.showSnackbar({children:<span>{result.message}</span>,type:SnackbarTypes.ERROR})\n        }\n        commonComponents.hideLoader()\n    }\n    const signOut = async () => {\n        commonComponents.showLoader(null)\n        await Logout()\n        commonComponents.hideLoader()\n        setUser(null)\n    }\n    return (\n        <UserContext.Provider value={{\n            user,\n            authenticate,\n            signOut\n        }}>\n            {children}\n        </UserContext.Provider>\n    )    \n}\n\n\n\nexport const useAuth = () => useContext(UserContext)"],"mappings":"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"},"metadata":{},"sourceType":"module"}