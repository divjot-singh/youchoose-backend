{"ast":null,"code":"import { getAuth, GoogleAuthProvider, OAuthCredential, signInWithPopup, signInWithCredential } from \"firebase/auth\";\nimport { initializeApp } from \"firebase/app\";\nimport { getAnalytics } from \"firebase/analytics\";\nimport { UserType } from '../entities/user';\nimport { LocalStorageKeys } from '../utils/localstorageKeys';\nimport LocalStorageMethods from './localstorageService';\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.REACT_APP_FIREBASE_API_ID,\n  measurementId: process.env.REACT_APP_FIREBASE_MEASUREMENT_ID\n};\nexport const InitialiseFirebaseApp = () => {\n  const app = initializeApp(firebaseConfig);\n  const analytics = getAnalytics(app);\n  return true;\n};\n_c = InitialiseFirebaseApp;\n\nconst getUser = (firebaseUser, userType, token, credential) => {\n  const user = {\n    display_name: firebaseUser.displayName || '',\n    email: firebaseUser.email || '',\n    photo_url: firebaseUser.photoURL || '',\n    uid: firebaseUser.uid,\n    user_type: userType,\n    token: token,\n    credential: credential\n  };\n  return user;\n};\n\nexport const SaveUserToLocalStorage = user => {\n  LocalStorageMethods.set(LocalStorageKeys.user_id, user.uid);\n  LocalStorageMethods.set(LocalStorageKeys.token, user.token);\n  LocalStorageMethods.set(LocalStorageKeys.type, user.user_type);\n  LocalStorageMethods.set(LocalStorageKeys.credential, JSON.stringify(user.credential.toJSON()));\n};\n_c2 = SaveUserToLocalStorage;\nexport const RemoveUserFromLocalStorage = () => {\n  LocalStorageMethods.delete(LocalStorageKeys.user_id);\n  LocalStorageMethods.delete(LocalStorageKeys.token);\n};\n_c3 = RemoveUserFromLocalStorage;\nexport const GetCurrentUser = async callback => {\n  try {\n    var _LocalStorageMethods$;\n\n    const auth = getAuth();\n    const credential = OAuthCredential.fromJSON(JSON.parse((_LocalStorageMethods$ = LocalStorageMethods.get(LocalStorageKeys.credential)) !== null && _LocalStorageMethods$ !== void 0 ? _LocalStorageMethods$ : '{}'));\n\n    if (credential) {\n      const result = await signInWithCredential(auth, credential);\n\n      if (result) {\n        const user = getUser(result.user, UserType.MODERATOR, (credential === null || credential === void 0 ? void 0 : credential.accessToken) || '', credential);\n        SaveUserToLocalStorage(user);\n        return user;\n      }\n\n      return null;\n    }\n\n    return null;\n  } catch (err) {\n    console.log(err);\n    return null;\n  }\n};\n_c4 = GetCurrentUser;\nexport const SignUpWithGoogle = async () => {\n  const auth = getAuth();\n  const provider = new GoogleAuthProvider();\n\n  try {\n    const result = await signInWithPopup(auth, provider);\n\n    if (result) {\n      const credential = GoogleAuthProvider.credentialFromResult(result);\n      const token = credential === null || credential === void 0 ? void 0 : credential.accessToken;\n      const user = getUser(result.user, UserType.MODERATOR, token || '', credential);\n      SaveUserToLocalStorage(user);\n      return user;\n    }\n\n    return null;\n  } catch (err) {\n    console.log(err);\n    return null;\n  }\n};\n_c5 = SignUpWithGoogle;\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"InitialiseFirebaseApp\");\n$RefreshReg$(_c2, \"SaveUserToLocalStorage\");\n$RefreshReg$(_c3, \"RemoveUserFromLocalStorage\");\n$RefreshReg$(_c4, \"GetCurrentUser\");\n$RefreshReg$(_c5, \"SignUpWithGoogle\");","map":{"version":3,"names":["getAuth","GoogleAuthProvider","OAuthCredential","signInWithPopup","signInWithCredential","initializeApp","getAnalytics","UserType","LocalStorageKeys","LocalStorageMethods","firebaseConfig","apiKey","process","env","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","projectId","REACT_APP_FIREBASE_PROJECT_ID","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","messagingSenderId","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","appId","REACT_APP_FIREBASE_API_ID","measurementId","REACT_APP_FIREBASE_MEASUREMENT_ID","InitialiseFirebaseApp","app","analytics","getUser","firebaseUser","userType","token","credential","user","display_name","displayName","email","photo_url","photoURL","uid","user_type","SaveUserToLocalStorage","set","user_id","type","JSON","stringify","toJSON","RemoveUserFromLocalStorage","delete","GetCurrentUser","callback","auth","fromJSON","parse","get","result","MODERATOR","accessToken","err","console","log","SignUpWithGoogle","provider","credentialFromResult"],"sources":["/Users/divjotsingh/Documents/Youchoose/youchoose/src/services/firebaseService.tsx"],"sourcesContent":["import React from 'react'\nimport { Auth, getAuth, getRedirectResult, GoogleAuthProvider, OAuthCredential, signInWithPopup, signInWithCredential, UserCredential, User as FirebaseUser } from \"firebase/auth\";\nimport { initializeApp } from \"firebase/app\";\nimport { getAnalytics } from \"firebase/analytics\";\nimport User, { UserType } from '../entities/user';\nimport { LocalStorageKeys } from '../utils/localstorageKeys';\nimport LocalStorageMethods from './localstorageService';\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.REACT_APP_FIREBASE_API_ID,\n  measurementId: process.env.REACT_APP_FIREBASE_MEASUREMENT_ID\n};\n\nexport const InitialiseFirebaseApp = () => {\n    const app = initializeApp(firebaseConfig);\n    const analytics = getAnalytics(app);\n    return true\n}\n\nconst getUser = (firebaseUser:FirebaseUser, userType:UserType, token:string, credential:OAuthCredential | null):User => {\n    const user:User = {\n        display_name: firebaseUser.displayName || '',\n        email: firebaseUser.email || '',\n        photo_url: firebaseUser.photoURL || '',\n        uid: firebaseUser.uid,\n        user_type: userType,\n        token: token,\n        credential:credential\n    } \n\n    return user;\n}\n\nexport const SaveUserToLocalStorage = (user:User) => {\n    LocalStorageMethods.set(LocalStorageKeys.user_id, user.uid)\n    LocalStorageMethods.set(LocalStorageKeys.token, user.token)\n    LocalStorageMethods.set(LocalStorageKeys.type, user.user_type)\n    LocalStorageMethods.set(LocalStorageKeys.credential, JSON.stringify(user.credential.toJSON()))\n}\n\nexport const RemoveUserFromLocalStorage = () => {\n    LocalStorageMethods.delete(LocalStorageKeys.user_id)\n    LocalStorageMethods.delete(LocalStorageKeys.token)\n}\n\n\n\nexport const GetCurrentUser = async (callback:(user:User | null) => void): Promise<User | null> => {\n    try{\n        const auth : Auth = getAuth();\n        const credential:OAuthCredential | null = OAuthCredential.fromJSON(JSON.parse(LocalStorageMethods.get(LocalStorageKeys.credential) ?? '{}'))\n        if(credential){\n            const result: UserCredential | null = await signInWithCredential(auth, credential)\n            if(result){\n                const user = getUser(result.user, UserType.MODERATOR, credential?.accessToken || '', credential);\n                SaveUserToLocalStorage(user);\n                return user;\n            }\n            return null;\n        }\n        return null\n    } catch(err) {\n        console.log(err) \n        return null;\n    } \n}\n\nexport const SignUpWithGoogle = async (): Promise<User | null> => {\n        const auth : Auth = getAuth();\n        const provider:GoogleAuthProvider = new GoogleAuthProvider();\n        try{\n            const result: UserCredential | null = await signInWithPopup(auth, provider)\n            if(result){\n                const credential: OAuthCredential | null = GoogleAuthProvider.credentialFromResult(result);\n                const token = credential?.accessToken;\n                const user = getUser(result.user, UserType.MODERATOR, token || '', credential);\n                SaveUserToLocalStorage(user);\n                return user;\n            }\n            return null;\n        } catch(err){\n            console.log(err) \n            return null;\n        }\n}\n"],"mappings":"AACA,SAAeA,OAAf,EAA2CC,kBAA3C,EAA+DC,eAA/D,EAAgFC,eAAhF,EAAiGC,oBAAjG,QAAmK,eAAnK;AACA,SAASC,aAAT,QAA8B,cAA9B;AACA,SAASC,YAAT,QAA6B,oBAA7B;AACA,SAAeC,QAAf,QAA+B,kBAA/B;AACA,SAASC,gBAAT,QAAiC,2BAAjC;AACA,OAAOC,mBAAP,MAAgC,uBAAhC;AACA,MAAMC,cAAc,GAAG;EACrBC,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC,0BADC;EAErBC,UAAU,EAAEH,OAAO,CAACC,GAAR,CAAYG,8BAFH;EAGrBC,SAAS,EAAEL,OAAO,CAACC,GAAR,CAAYK,6BAHF;EAIrBC,aAAa,EAAEP,OAAO,CAACC,GAAR,CAAYO,iCAJN;EAKrBC,iBAAiB,EAAET,OAAO,CAACC,GAAR,CAAYS,sCALV;EAMrBC,KAAK,EAAEX,OAAO,CAACC,GAAR,CAAYW,yBANE;EAOrBC,aAAa,EAAEb,OAAO,CAACC,GAAR,CAAYa;AAPN,CAAvB;AAUA,OAAO,MAAMC,qBAAqB,GAAG,MAAM;EACvC,MAAMC,GAAG,GAAGvB,aAAa,CAACK,cAAD,CAAzB;EACA,MAAMmB,SAAS,GAAGvB,YAAY,CAACsB,GAAD,CAA9B;EACA,OAAO,IAAP;AACH,CAJM;KAAMD,qB;;AAMb,MAAMG,OAAO,GAAG,CAACC,YAAD,EAA4BC,QAA5B,EAA+CC,KAA/C,EAA6DC,UAA7D,KAAwG;EACpH,MAAMC,IAAS,GAAG;IACdC,YAAY,EAAEL,YAAY,CAACM,WAAb,IAA4B,EAD5B;IAEdC,KAAK,EAAEP,YAAY,CAACO,KAAb,IAAsB,EAFf;IAGdC,SAAS,EAAER,YAAY,CAACS,QAAb,IAAyB,EAHtB;IAIdC,GAAG,EAAEV,YAAY,CAACU,GAJJ;IAKdC,SAAS,EAAEV,QALG;IAMdC,KAAK,EAAEA,KANO;IAOdC,UAAU,EAACA;EAPG,CAAlB;EAUA,OAAOC,IAAP;AACH,CAZD;;AAcA,OAAO,MAAMQ,sBAAsB,GAAIR,IAAD,IAAe;EACjD1B,mBAAmB,CAACmC,GAApB,CAAwBpC,gBAAgB,CAACqC,OAAzC,EAAkDV,IAAI,CAACM,GAAvD;EACAhC,mBAAmB,CAACmC,GAApB,CAAwBpC,gBAAgB,CAACyB,KAAzC,EAAgDE,IAAI,CAACF,KAArD;EACAxB,mBAAmB,CAACmC,GAApB,CAAwBpC,gBAAgB,CAACsC,IAAzC,EAA+CX,IAAI,CAACO,SAApD;EACAjC,mBAAmB,CAACmC,GAApB,CAAwBpC,gBAAgB,CAAC0B,UAAzC,EAAqDa,IAAI,CAACC,SAAL,CAAeb,IAAI,CAACD,UAAL,CAAgBe,MAAhB,EAAf,CAArD;AACH,CALM;MAAMN,sB;AAOb,OAAO,MAAMO,0BAA0B,GAAG,MAAM;EAC5CzC,mBAAmB,CAAC0C,MAApB,CAA2B3C,gBAAgB,CAACqC,OAA5C;EACApC,mBAAmB,CAAC0C,MAApB,CAA2B3C,gBAAgB,CAACyB,KAA5C;AACH,CAHM;MAAMiB,0B;AAOb,OAAO,MAAME,cAAc,GAAG,MAAOC,QAAP,IAAqE;EAC/F,IAAG;IAAA;;IACC,MAAMC,IAAW,GAAGtD,OAAO,EAA3B;IACA,MAAMkC,UAAiC,GAAGhC,eAAe,CAACqD,QAAhB,CAAyBR,IAAI,CAACS,KAAL,0BAAW/C,mBAAmB,CAACgD,GAApB,CAAwBjD,gBAAgB,CAAC0B,UAAzC,CAAX,yEAAmE,IAAnE,CAAzB,CAA1C;;IACA,IAAGA,UAAH,EAAc;MACV,MAAMwB,MAA6B,GAAG,MAAMtD,oBAAoB,CAACkD,IAAD,EAAOpB,UAAP,CAAhE;;MACA,IAAGwB,MAAH,EAAU;QACN,MAAMvB,IAAI,GAAGL,OAAO,CAAC4B,MAAM,CAACvB,IAAR,EAAc5B,QAAQ,CAACoD,SAAvB,EAAkC,CAAAzB,UAAU,SAAV,IAAAA,UAAU,WAAV,YAAAA,UAAU,CAAE0B,WAAZ,KAA2B,EAA7D,EAAiE1B,UAAjE,CAApB;QACAS,sBAAsB,CAACR,IAAD,CAAtB;QACA,OAAOA,IAAP;MACH;;MACD,OAAO,IAAP;IACH;;IACD,OAAO,IAAP;EACH,CAbD,CAaE,OAAM0B,GAAN,EAAW;IACTC,OAAO,CAACC,GAAR,CAAYF,GAAZ;IACA,OAAO,IAAP;EACH;AACJ,CAlBM;MAAMT,c;AAoBb,OAAO,MAAMY,gBAAgB,GAAG,YAAkC;EAC1D,MAAMV,IAAW,GAAGtD,OAAO,EAA3B;EACA,MAAMiE,QAA2B,GAAG,IAAIhE,kBAAJ,EAApC;;EACA,IAAG;IACC,MAAMyD,MAA6B,GAAG,MAAMvD,eAAe,CAACmD,IAAD,EAAOW,QAAP,CAA3D;;IACA,IAAGP,MAAH,EAAU;MACN,MAAMxB,UAAkC,GAAGjC,kBAAkB,CAACiE,oBAAnB,CAAwCR,MAAxC,CAA3C;MACA,MAAMzB,KAAK,GAAGC,UAAH,aAAGA,UAAH,uBAAGA,UAAU,CAAE0B,WAA1B;MACA,MAAMzB,IAAI,GAAGL,OAAO,CAAC4B,MAAM,CAACvB,IAAR,EAAc5B,QAAQ,CAACoD,SAAvB,EAAkC1B,KAAK,IAAI,EAA3C,EAA+CC,UAA/C,CAApB;MACAS,sBAAsB,CAACR,IAAD,CAAtB;MACA,OAAOA,IAAP;IACH;;IACD,OAAO,IAAP;EACH,CAVD,CAUE,OAAM0B,GAAN,EAAU;IACRC,OAAO,CAACC,GAAR,CAAYF,GAAZ;IACA,OAAO,IAAP;EACH;AACR,CAjBM;MAAMG,gB"},"metadata":{},"sourceType":"module"}